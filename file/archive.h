#pragma once

#include "../includes.h"

namespace libredwgpp {

class ISchema;

class Archive
{
  ////////////////////////////////////////////////////////////////
  // Definitions
  ////////////////////////////////////////////////////////////////
  public:

  ////////////////////////////////////////////////////////////////
  // Members
  ////////////////////////////////////////////////////////////////
  private:
    /// The filebuffer to read from
    std::ifstream fileStream_;

    /// The size of the file
    size_t size_;

  ////////////////////////////////////////////////////////////////
  // Constructors & Destructor
  ////////////////////////////////////////////////////////////////
  public:
    Archive();
    virtual ~Archive();

  ////////////////////////////////////////////////////////////////
  // Operators
  ////////////////////////////////////////////////////////////////
  private:

  ////////////////////////////////////////////////////////////////
  // Functions
  ////////////////////////////////////////////////////////////////
  public:
    /// Restore a schema from a file
    /// @param pathFile a (valid) file path to a drawing file
    /// @param ptrSchema a pointer to a schema restored from that file. If NULL, will create a new schema
    core::ResultCode restore(const boost::filesystem::path& pathFile, boost::shared_ptr<ISchema>& ptrSchema);

    /// Read bytes from the file
    /// @param buffer the buffer to write data into
    /// @param pos the start position in the file
    /// @param len the length of data to read
    /// @param strict if set to false will read as much as possible even if less than len
    core::ResultCode read(core::IWriteBuffer& buffer, size_t pos, size_t len, bool strict = true);
};

////////////////////////////////////////////////////////////////

}
