#pragma once

#include "../page.h"
#include "../parser.h"

namespace libredwgpp {

//class SectionInfo;
//class SectionMap;

class Parser2000 : public Parser
{
  ////////////////////////////////////////////////////////////////
  // Definitions
  ////////////////////////////////////////////////////////////////
  private:
    enum Type {
      HEADER = 0,
      CLASS = 1,
      OBJECT = 2,
      SPECIAL = 3,
      MEASUREMENT = 4,
      OTHER = 5
    };

  ////////////////////////////////////////////////////////////////
  // Members
  ////////////////////////////////////////////////////////////////
  private:
    /// Map to all sections
    std::vector<Page> vPages_;

  ////////////////////////////////////////////////////////////////
  // Constructors & Destructor
  ////////////////////////////////////////////////////////////////
  public:
    Parser2000(Archive& archive);

    virtual ~Parser2000();

  ////////////////////////////////////////////////////////////////
  // Operators
  ////////////////////////////////////////////////////////////////
  private:

  ////////////////////////////////////////////////////////////////
  // Functions
  ////////////////////////////////////////////////////////////////
  private:
    virtual boost::shared_ptr<Decoder> getDecoder(int compressionMethod);

    virtual core::ResultCode getSectionBuffer(Section::Type st, DWGBuffer& buffer);

    virtual core::ResultCode parseFileHeader();
    virtual core::ResultCode parseInfo();
    virtual core::ResultCode parseMap();

    virtual core::ResultCode parseObjects(ObjectsParser& parser);

};

////////////////////////////////////////////////////////////////

}
